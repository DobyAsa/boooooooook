<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta charset="UTF-8">
		<title>后台管理页面</title>
		<link rel="stylesheet" type="text/css" th:href="@{/css/cart.css}" />
		<link rel="stylesheet" type="text/css" th:href="@{/dist/css/bootstrap.min.css}">
		<link rel="stylesheet" type="text/css" th:href="@{/css/index.css}"/>
		<link rel="stylesheet" type="text/css" th:href="@{/css/animate.css}"/>
		<link rel="stylesheet" th:href="@{/layui/css/layui.css}">

	</head>

	<body>
	<!--导航部分  begin-->
	<div th:replace="common/header :: nav"></div>
	<!--导航部分 end-->

	<!--最顶端轮播图片 begin-->
<!--	<div th:replace="common/carousel :: carousel"></div>-->
	<!--最顶端轮播图片 end-->
		<!--购物车 begin-->
		<!--外层div-->
		<div class="container">
			<!--左边-->
			<div class="col-md-8 col-sm-12" style="width:100%">
				<!--左边-->
				<ol class="breadcrumb">
					<li>
						<a href="#" class="text-success"><span class="glyphicon glyphicon-heart"></span>&nbsp;&nbsp;我的宝贝</a>
					</li>
				</ol>

				<!--购物车表格 begin-->
				<div class="table-responsive" id="imgDiv">
					<table class="table table-hover table-striped" style="vertical-align:middle;">
						<thead>
						<tr>
							<td colspan="8">
								<label class="text-primary">显示条数:</label>
								<select id="cartSzie" class="form-control" style="display: inline" onchange="displaySize(this)">
									<option value="2">2</option>
									<option value="4">4</option>
									<option value="6" selected>6</option>
									<option value="8">8</option>
								</select>
							</td>
						</tr>
						<tr class="text-success success">
							<th style="width: 30px;"><input type="checkbox" id="selectAll" onclick="selectAll(this)"></th>
							<th id="sequence">序号</th>
							<th>图片</th>
							<th>书名</th>
							<th>作者</th>
							<th>出版社</th>
							<th>分类</th>
							<th>原价</th>
							<th>现价</th>
							<th>简介</th>
							<th>操作</th>
						</tr>
						</thead>
						<tbody id="tby" th:each="book,iter:${bookList}">
						<tr>
							<td style="width: 30px;"><input type="checkbox" name="cks" th:value="${book.id}"></td>
							<td th:text="${book.id}">1001</td>
							<td><img src="images/tenxunchuan.jpg" th:src="@{'/public/' + ${book.imgUrl}}"></td>
							<td th:text="${book.name}">腾讯传</td>
							<td th:text="${book.author}">作者</td>
							<td th:text="${book.publisher}">黑龙江科学技术出版社</td>
							<td th:text="${book.cate}">分类</td>
<!--							<span th:switch="${book.cate}">
								<td th:case="'SELECTTED'">精选图书</td>
								<td th:case="'RECOMMEND'">精选图书</td>
								<td th:case="'BARGAGIN'">精选图书</td>
							</span>-->

							<td th:text="${book.oldPrice}">原价</td>
							<td th:text="${book.newPrice}">1现价00$</td>
							<td style="width: 146px;" th:text="${book.info}"><font size=2> 一个作家，一本书，激起你行走的渴望，改变你旅行的意义。陈丹燕旅行文学。 </font> </td>
							<td>
<!--
								<a th:href="@{/admin/touUpdateProductPage(proId=${product.proId})}" class="btn btn-info">修改</a>
								<a th:href="@{/admin/doDeleteProductPage(proId=${product.proId})}" class="btn btn-danger">删除</a>
-->
								<a class="btn btn-info">修改</a>
								<a class="btn btn-danger">删除</a>
							</td>

						</tr>

						</tbody>
						<tfoot>
						<tr>
							<td colspan="5"></td>
							<td class="text-success">总价:</td>
							<td class="text-success">345$:</td>
						</tr>
						<tr style="background-color: white;">
							<td>
								<a href="index.html" class="btn btn-info">&lt;&lt;继续购买</a>
							</td>
							<td><button class="btn btn-danger" data-toggle="modal" data-target="#myModal" onclick="del()">删除商品</button></td>
							<td colspan="4"></td>
							<td>
								<a href="confirm_order.html" class="btn btn-warning">结算商品</a>
							</td>
						</tr>
						</tfoot>
					</table>
				</div>
				<!--购物车 end-->

				<!--删除提示模态框 begin-->
				<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
					<!--如果没有选中任何一个商品的时候,出现-->
					<div id="first_del" style="display: none;">
						<div class="modal-dialog">
							<div class="modal-content">
								<div class="modal-header">
									<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
									<h4 class="modal-title text-warning" id="myModalLabel">抱歉!请您先选择商品!</h4>
								</div>
								<div class="modal-body">请选进行勾选!再执行删除删除!</div>
								<div class="modal-footer">
									<button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
								</div>
							</div>
							<!-- /.modal-content -->
						</div>
					</div>
					<!--first_del  end-->

					<!--如果没有选中了一个商品的时候,出现-->
					<div id="two_del" style="display: none;">
						<div class="modal-dialog">
							<div class="modal-content">
								<div class="modal-header">
									<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
									<h4 class="modal-title text-warning" >删除商品,慎重操作!</h4>
								</div>
								<div class="modal-body">此操作一旦进行,数据将不可恢复!</div>
								<div class="modal-footer">
									<button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
									<button type="button" class="btn btn-danger" onclick="delRows(this)">确定删除</button>
								</div>
							</div>
							<!-- /.modal-content -->
						</div>
					</div>
					<!--two_del  end-->
				</div>
				<!--删除提示模态框 end-->
			</div>


		</div>

		<div class="container">
			<!--首页底部信息 begin-->
			<div th:replace="common/footer :: footer"></div>
		</div>
		<!--end-->

		<!--引入js文件-->
		<script src="js/details.js" th:src="@{/js/details.js}" type="text/javascript" charset="utf-8"></script>
		<script src="js/cart.js" th:src="@{/js/cart.js}" type="text/javascript" charset="utf-8"></script>
		<script src="dist/js/jquery.min.js" th:src="@{/dist/js/jquery.min.js}"></script>
		<script src="js/carousel.js" th:src="@{/js/carousel.js}" type="text/javascript" charset="utf-8"></script>
		<script src="dist/js/bootstrap.min.js" th:src="@{/dist/js/bootstrap.min.js}"></script>
		<script src="js/wow.js" th:src="@{/js/wow.js}"></script>
		<script th:src="@{/layui/layui.js}"></script>
		<script th:inline="javascript">
			//获取应用路径
			var contextPath = [[${#request.getContextPath()}]];

		</script>
		<script type="text/javascript">
			if(!(/msie [6|7|8|9]/i.test(navigator.userAgent))) {
				new WOW().init();
			};

			//修改商品数量
			function minus(cartId,price,index) {
				var count = parseInt($("#cartCount" + index).val());
				var _price = parseFloat(price);
				if(count != 1){
					$("#cartCount" + index ).val(count - 1);
					//toFixed(保留小数位)
					var singlePrice = parseFloat((count - 1) * _price).toFixed(1);
					$("#cartPrice" + index ).html(singlePrice);
					updateCart(cartId,count - 1);
				}
			}

			function plus(cartId,price,index) {
				var count = parseInt($("#cartCount" + index).val());
				var _price = parseFloat(price);
				$("#cartCount" + index ).val(count + 1);
				var singlePrice = parseFloat((count + 1) * _price).toFixed(1);
				$("#cartPrice" + index ).html(singlePrice);
				updateCart(cartId,count + 1);
			}
			//手动输入商品数量
			function countChange(cartId,price,index) {
				var count = parseInt($("#cartCount" + index).val());
				if (count < 1){
					alert('商品数量须大于0')
					return;
				}
				var _price = parseFloat(price);
				$("#cartCount" + index ).val(count);
				var singlePrice = parseFloat(count * _price).toFixed(1);
				$("#cartPrice" + index ).html(singlePrice);
				updateCart(cartId,count);
			}

			//更新购物车信息
			function updateCart(cartId,count) {
				$.ajax({
					url:contextPath + "/cart/update",
					data:{"id":cartId,"count":count},
					method:"post",
					success:function (data) {
						var total = parseFloat(data).toFixed(1);
						$("#total").html('总价' + total + '元');
						$(".cartPrice").html(total);
					}
				})
			}

			//确认订单
			function confirmOrder() {
				//存储购物记录的id
				var ids = '';
				var thirdModel = document.getElementById("third_del");
				//判断是否选择了商品
				var count = 0;
				//获取所有的checkbox
				var cks = document.getElementsByName("cks");
				//遍历
				for(var i = 0; i < cks.length; i++) {
					if(cks[i].checked) {
						count++;
						ids += cks[i].value + ",";
					}
				}
				if(count == 0) {
					alert('请选择图书！');
					// thirdModel.style.display = "block";
					// $("#third_del").css("display","block");
				} else {
					window.location.href = contextPath + '/order/confirm?ids=' + ids.substring(0,ids.length-1);
				}
			}
			//每过2秒钟进行一次轮播
			$(function() {
				$('#myCarousel').carousel({
					interval: 2000
				});
			});

			//根据图书名搜索
			function searchBookName() {
				var inputBookName = $("#inputBookName").val();
				if (inputBookName != ''){
					window.location.href = contextPath + "/book/searchBook?inputBookName=" + inputBookName;
				}else alert('请输入图书名')
			}
/*
			$(function() {
				if ()
				document.getElementById('category').innerHTML="要赋的值";
			});*/
		</script>

	<style type="text/css">
		td {text-align: center}
		th {text-align: center}

	</style>
	</body>

</html>