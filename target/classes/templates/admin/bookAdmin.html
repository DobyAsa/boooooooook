<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta charset="UTF-8">
		<title>后台管理页面</title>
		<link rel="stylesheet" type="text/css" th:href="@{/css/cart.css}" />
		<link rel="stylesheet" type="text/css" th:href="@{/dist/css/bootstrap.min.css}">
		<link rel="stylesheet" type="text/css" th:href="@{/css/index.css}"/>
		<link rel="stylesheet" type="text/css" th:href="@{/css/animate.css}"/>
		<link rel="stylesheet" th:href="@{/layui/css/layui.css}">

	</head>

	<body>
	<!--导航部分  begin-->
	<div th:replace="common/header :: nav"></div>
	<!--导航部分 end-->

		<!--购物车 begin-->
		<!--外层div-->

		<div id="allBooksData"></div>
		<div class="container">
			<!--首页底部信息 begin-->
			<div th:replace="common/footer :: footer"></div>
		</div>
		<!--end-->

		<!--引入js文件-->
		<script src="js/details.js" th:src="@{/js/details.js}" type="text/javascript" charset="utf-8"></script>
		<script src="js/cart.js" th:src="@{/js/cart.js}" type="text/javascript" charset="utf-8"></script>
		<script src="dist/js/jquery.min.js" th:src="@{/dist/js/jquery.min.js}"></script>
		<script src="js/carousel.js" th:src="@{/js/carousel.js}" type="text/javascript" charset="utf-8"></script>
		<script src="dist/js/bootstrap.min.js" th:src="@{/dist/js/bootstrap.min.js}"></script>
		<script src="js/wow.js" th:src="@{/js/wow.js}"></script>
		<script th:src="@{/layui/layui.js}"></script>
		<script th:inline="javascript">
			//获取应用路径
			var contextPath = [[${#request.getContextPath()}]];

		</script>
		<script type="text/javascript">
			if(!(/msie [6|7|8|9]/i.test(navigator.userAgent))) {
				new WOW().init();
			};
			//根据图书名搜索
			function searchBookName() {
				var inputBookName = $("#inputBookName").val();
				if (inputBookName != ''){
					window.location.href = contextPath + "/book/searchBook?inputBookName=" + inputBookName;
				}else alert('请输入图书名')
			}


			//预览图书简介
			function displayInfo(info) {
				layer.open({
					title: '简介'
					,content: info
					,area: '500px'
				});

			}

			//删除图书
			function deleteBook(bookId){
				layer.confirm('确定删除？', {
					icon:3,
					btn: ['确定', '取消']
				}, function(index, layero){
					//按钮【按钮一】的回调
					$.ajax({
						url: contextPath + "/admin/deleteBook",
						method: "post",
						data: {"bookId":bookId},
						success: function (data) {
							if (data == 'success') {
								window.location.href = contextPath + "/admin/toBookAdmin"
							} else layer.msg('修改失败')
						}
					})
				}, function(index){
					return ;
				});
			}
		</script>

	<style type="text/css">
		td {text-align: center}
		th {text-align: center}
	</style>
	</body>
	<script>
		//分页js
		$(function () {
			$("#allBooksData").load(contextPath + "/admin/getBookListByPage",queryData(1,''))
		})

		function loadData(page,pageSize) {
			$("#allBooksData").load(contextPath + "/admin/getBookListByPage",queryData(page,pageSize))

		}

		//跳转到指定页
		function goPage(pageSize) {
			var page = $("#inputPage").val();
			$("#allBooksData").load(contextPath + "/admin/getBookListByPage",queryData(page,pageSize))

		}

		//修改指定每页显示的记录数
		function loadDataBySize(obj) {
			$("#allBooksData").load(contextPath + "/admin/getBookListByPage",queryData(1,obj.value))
		}
		//查询
		function queryData(page, pageSize,orderNum,tradeStatus,orderBy,startTime,endTime) {
			var query = {};
			query.page = page;
			query.pageSize = pageSize == '' ? 3 : pageSize;
			query.orderNum = orderNum == undefined ? '' : orderNum;
			query.tradeStatus = tradeStatus == undefined ? '' : tradeStatus;
			query.orderBy = orderBy == undefined ? '' : orderBy;
			query.startTime = startTime == undefined ? '' : startTime;
			query.endTime = endTime == undefined ? '' : endTime;
			return query;
		}
	</script>
</html>